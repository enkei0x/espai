; PlatformIO Project Configuration File
;
; ESPAI - Unified AI API Client for ESP32
;
; Build targets:
;   pio run -e esp32dev          # Build for ESP32
;   pio test -e native           # Run native tests
;   pio test -e native -f test_types   # Run specific test

[platformio]
default_envs = esp32dev
src_dir = src
lib_dir = .
test_dir = test

[common]
build_flags =
    -std=gnu++17
    -Wall
    -Wextra
lib_deps =
    bblanchon/ArduinoJson@^7.4.0

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags =
    ${common.build_flags}
    -D ARDUINO_ESP32_DEV
lib_deps =
    ${common.lib_deps}

[env:esp32s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags =
    ${common.build_flags}
    -D ARDUINO_ESP32S3_DEV
    -D BOARD_HAS_PSRAM
lib_deps =
    ${common.lib_deps}

[env:esp32c3]
platform = espressif32
board = esp32-c3-devkitm-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags =
    ${common.build_flags}
    -D ARDUINO_ESP32C3_DEV
lib_deps =
    ${common.lib_deps}

[env:native]
platform = native
build_flags =
    -std=c++17
    -Wall
    -Wextra
    -Wno-unused-parameter
    -D NATIVE_TEST
    -D UNIT_TEST
    -I src
    -I src/core
    -I src/providers
    -I test/unity_config
lib_deps =
    throwtheswitch/Unity@^2.6.0
    bblanchon/ArduinoJson@^7.4.0
lib_ignore = Unity_examples
test_framework = unity
test_build_src = yes
test_filter = native/*

[env:esp32_test]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
test_framework = unity
build_flags =
    ${common.build_flags}
    -D UNIT_TEST
lib_deps =
    ${common.lib_deps}

[env:esp32dev_debug]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
build_type = debug
build_flags =
    ${common.build_flags}
    -D ESPAI_DEBUG=1
    -D CORE_DEBUG_LEVEL=4
lib_deps =
    ${common.lib_deps}

[env:esp32s3_test]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
test_framework = unity
test_filter = embedded/*
test_ignore = native/*
build_flags =
    ${common.build_flags}
    -D ESPAI_DEBUG=1
    -D BOARD_HAS_PSRAM
    -I test/embedded
lib_deps =
    ${common.lib_deps}
    throwtheswitch/Unity@^2.6.0
lib_ignore = Unity_examples
monitor_speed = 115200
